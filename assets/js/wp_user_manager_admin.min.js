/*! WP User Manager - v1.1.0
 * http://wpusermanager.com
 * Copyright (c) 2015; * Licensed GPLv2+ */
jQuery(document).ready(function(e){var s={init:function(){this.general(),this.restore_emails(),this.remove_roles(),this.drag_and_drop_fields_table(),this.confirm_dialog(),this.admin_upload()},general:function(){e.isFunction(e.fn.select2)&&(jQuery("select.select2").select2({width:"resolve"}),jQuery(".wppf-multiselect, select.select2_multiselect").select2())},restore_emails:function(){e("#wpaam-restore-emails").on("click",function(s){if(s.preventDefault(),!confirm(wpaam_admin_js.confirm))return!1;var a=e("#wpaam_backend_security").val();e.ajax({type:"GET",dataType:"json",url:wpaam_admin_js.ajax,data:{action:"wpaam_restore_emails",wpaam_backend_security:a},beforeSend:function(){e(".wpaam-spinner").remove(),e(".wpaam-ajax-done-message").remove(),e("#wpaam-restore-emails").after('<span id="wpaam-spinner" class="spinner wpaam-spinner is-active"></span>')},success:function(s){e("#wpaam-restore-emails").after('<p class="wpaam-ajax-done-message"> <span class="dashicons dashicons-yes"></span> '+s.data.message+"</p>"),e(".wpaam-spinner").remove()},error:function(e,s,a){alert(e.responseText)}})})},remove_roles:function(){e("#wpaam-remove-roles").on("click",function(s){if(s.preventDefault(),!confirm(wpaam_admin_js.confirm))return!1;var a=e("#wpaam_user_roles_security").val();e.ajax({type:"GET",dataType:"json",url:wpaam_admin_js.ajax,data:{action:"wpaam_remove_roles",wpaam_user_roles_security:a},beforeSend:function(){e(".wpaam-spinner").remove(),e(".wpaam-ajax-done-message").remove(),e("#wpaam-remove-roles").after('<span id="wpaam-spinner" class="spinner wpaam-spinner is-active"></span>')},success:function(s){e("#wpaam-remove-roles").after('<p class="wpaam-ajax-done-message"> <span class="dashicons dashicons-yes"></span> '+s.data.message+"</p>"),e(".wpaam-spinner").remove()},error:function(e,s,a){alert(e.responseText)}})})},drag_and_drop_fields_table:function(){e.isFunction(e.fn.sortable)&&e(".users_page_wpaam-profile-fields tbody").sortable({helper:this.sortable_table_fix,axis:"y",cursor:"pointer",opacity:.5,placeholder:"row-dragging",delay:150,handle:".column-order, .move-field",update:function(a,i){e(this).children("tr").each(function(){e(this).data("priority",e(this).index())}),dataArray=e.map(e(this).children("tr"),function(s){return{priority:e(s).data("priority"),field_id:e(s).data("field-id")}});var t=e("#wpaam_fields_editor_nonce").val();e.ajax({type:"POST",dataType:"json",url:wpaam_admin_js.ajax,data:{action:"wpaam_update_fields_order",items:dataArray,wpaam_editor_nonce:t},beforeSend:function(){s.display_loader(),s.remove_message()},success:function(a){e(".users_page_wpaam-profile-fields").find("tr").removeClass("alternate"),e(".users_page_wpaam-profile-fields").find("tr:even").addClass("alternate"),s.hide_loader(),s.display_success_message(".wpaam-page-title",a.data.message)},error:function(e,s,a){alert(e.responseText)}})}}).disableSelection()},sortable_table_fix:function(s,a){var i=a.children(),t=a.clone();return t.children().each(function(s){e(this).width(i.eq(s).width())}),t},display_loader:function(){var s=e(".wp-list-table").height();e(".wpaam-table-loader").css("display","table"),e(".wpaam-table-loader").css("height",s),e(".wpaam-table-loader #wpaam-spinner").addClass("is-active")},hide_loader:function(){e(".wpaam-table-loader").hide(),e(".wpaam-table-loader #wpaam-spinner").removeClass("is-active")},display_success_message:function(s,a,i,t){return i=i||"updated",t=t||!0,e(s).after('<div class="wpaam-message '+i+' notice is-dismissible"><p>'+a+"</p></div>"),t?(e("html, body").animate({scrollTop:0},"slow"),!1):void 0},remove_message:function(){e(".wpaam-message").remove()},confirm_dialog:function(){e("#wpaam-group-settings-edit a.submitdelete, .wpaam-confirm-dialog").click(function(e){return confirm(wpaam_admin_js.confirm)})},admin_upload:function(){var s;window.formfield="",e(document.body).on("click",".wpaam_settings_upload_button",function(a){a.preventDefault();e(this);return window.formfield=e(this).parent().prev(),s?void s.open():(s=wp.media.frames.file_frame=wp.media({title:wpaam_admin_js.upload_title,button:{text:wpaam_admin_js.use_this_file},multiple:!1}),s.on("select",function(){attachment=s.state().get("selection").first().toJSON(),window.formfield.val(attachment.url)}),void s.open())})}};s.init(),jQuery("#wpaam_dashboard_users").length&&e.ajax({type:"GET",data:{action:"wpaam_load_dashboard_users_overview"},url:wpaam_admin_js.ajax,success:function(s){e("#wpaam_dashboard_users .inside").html(s)}})});